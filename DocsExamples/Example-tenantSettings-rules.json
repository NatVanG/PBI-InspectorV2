{
  "rules": [
    {
      "id": "AZURE_MAPS_ENABLED",
      "name": "Check tenant setting for AzureMaps is enabled if we want to deploy a Power BI report that uses the visual.",
      "logType": "error",
      "disabled": false,
      "itemtype": "*",
      "test": [
        {
          "if": [
            {
              "some": [
                {
                  "query": [
                    {
                      "part": "visual.json$"
                    },
                    {
                      "path": "$.*.visual.visualType"
                    }
                  ]
                },
                {
                  "==": [
                    {
                      "var": ""
                    },
                    "azureMap"
                  ]
                }
              ]
            },
            {
              "query": [
                {
                  "part": "tenant-settings.json$"
                },
                {
                  "query": [
                    {
                      "path": "$[0][?@.settingName=='AzureMaps'].enabled"
                    },
                    {
                      "var": 0
                    }
                  ]
                }
              ]
            },
            true
          ]
        },
        true
      ]
    },
    {
      "id": "TENANTSETTINGS_SQLDB_ENABLED",
      "name": "Check tenant setting for SQLDB is enabled if we want to deploy a SQL Database.",
      "logType": "error",
      "disabled": false,
      "itemtype": "*",
      "test": [
        {
          "if": [
            {
              "some": [
                {
                  "query": [
                    {
                      "part": ".platform$"
                    },
                    {
                      "path": "$.*.metadata.type"
                    }
                  ]
                },
                {
                  "==": [
                    {
                      "var": ""
                    },
                    "SQLDatabase"
                  ]
                }
              ]
            },
            {
              "query": [
                {
                  "part": "tenant-settings.json$"
                },
                {
                  "query": [
                    {
                      "path": "$[0][?@.settingName=='SQLDbNativeTenant'].enabled"
                    },
                    {
                      "var": 0
                    }
                  ]
                }
              ]
            },
            true
          ]
        },
        true
      ]
    }
  ]
}